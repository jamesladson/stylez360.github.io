!function(){"use strict";const t="init",e="onClick",i="onContentWillChange",n="onContentChange",s="onContentDidChange",o="onViewerWillOpen",a="onViewerOpened",r="onViewerClosed",c="onViewerDidClose";var d={__proto__:null,init:t,onClick:e,onContentWillChange:i,onContentChange:n,onContentDidChange:s,onViewerWillOpen:o,onViewerOpened:a,onViewerClosed:r,onViewerDidClose:c};const l=["finance.yahoo.com","news.yahoo.com","sports.yahoo.com"],h=new RegExp(/rs="([^"]*)"/),w={lmsid:"lmsid",lpstaid:"lpstaid",lu:"lu",pct:"pageContentType",pd:"pageDesign",pl:"pl",pt:"pageType",revsp:"revsp",ver:"appName"},u=t=>new Promise((e=>setTimeout(e,t))),p=(t,{className:e,id:i,tagName:n})=>{if(t)return e&&!t.classList.contains(e)||i&&i!==t.id||n&&t.tagName!==n?p(t.parentElement,{className:e,id:i,tagName:n}):t},m=t=>{if(!t||t.startsWith("/"))return t;const{hostname:e,pathname:i}=new URL(t);if(l.includes(e)&&e!==window.location.hostname){const[t]=e.split(".");return`/${t}${i}`}return i},f=t=>{const{hostname:e}=new URL(t);return e||""};function v(t){const e=[];for(const i in t)if(t.hasOwnProperty(i)){const n=t[i];void 0!==n&&e.push(`${i}=${n}`)}return e.join("&")}function g(t){let e="p.gif";return"finance"!==t&&"news"!==t&&"sports"!==t||(e="_td_api/beacon/error"),e}function y(){const t=window.navigator&&(navigator.connection||navigator.mozConnection||navigator.webkitConnection)||{};return{downlink:t.downlink||"",downlinkMax:t.downlinkMax||"",effectiveType:t.effectiveType||"",rtt:t.rtt||"",saveData:t.saveData||"",type:t.type||""}}const A=t=>{if(t)return t.hasAttribute("data-uuid")?t.getAttribute("data-uuid"):t.hasAttribute("data-wf-caas-uuid")?t.getAttribute("data-wf-caas-uuid"):A(t.parentElement)},C=(t,e)=>{let i=t;for(const t of e.split(".")){if(!i||!i.hasOwnProperty(t))return;i=i[t]}return i},b=()=>{const{hostname:t,port:e,protocol:i}=window.location;return"localhost"!==t&&"4443"!==e&&"http:"!==i},S=()=>{var t,e,i;return(null===(t=window.vzm)||void 0===t||null===(e=t.getPageContext)||void 0===e?void 0:e.call(t))||(null===(i=window.YAHOO)||void 0===i?void 0:i.context)},k=t=>{const e=S(),i=(null==e?void 0:e.bucket)||(null==e?void 0:e.bucketId)||"";return{pg:{device:e.device||"",intl:e.intl||"",property:t,rid:e.rid,test:i}}},I=t=>{if(!t||!t.parentElement)return;const e=p(t.parentElement,{id:"content-articles-wrapper"});if(!e)return;const i=e.querySelectorAll("div.wafer-caas,div.wafer-caas-complete");return Array.from(i).findIndex((e=>e===t))+1},P=t=>(window.wafer.features.isPWA&&(t=((t,e,i)=>{const n=new URL(t);return n.searchParams.set(e,i),n.href})(t,"apptype","pwa")),t);const E="AUTO",V=["INARTICLE","INARTICLE-1","WIDGET","WIDGET-1"];const N={article:"story",cavideo:"video",photoset:"story",preview:"story",slideshow:"story"};const R=window.performance&&"clearMarks"in window.performance;const L=[new class{constructor(t){this.articleUrl="",this.refererUrl="",this.config=t,this.homeUrl=window.location.href,this.spaceid="",this.keys={}}init(){var t,e;window.wafer.on("caas:article:init",this.updateRapidAttributes.bind(this)),window.wafer.on("caas:article:inview",this.beacon.bind(this)),this.keys=null===(t=window.rapidInstance)||void 0===t?void 0:t.getRapidAttribute("keys"),this.spaceid=null===(e=window.rapidInstance)||void 0===e?void 0:e.getRapidAttribute("spaceid")}onViewerWillOpen(){this.homeUrl=location.href}onClick(t){"slideshow"===t.type?this.onSlideshowClick(t):"link"===t.type&&this.onLinkClick(t)}async onViewerClosed(){if(!window.rapidInstance)return;const t=this.spaceid,e={_R:this.articleUrl,_w:this.homeUrl,navtype:"client"};let i;i="desktop"===this.config.device?{elm:"btn",elmt:"cl",itc:0,rspns:"cl",tar:f(this.homeUrl)}:{elm:"backbtn",itc:0,tar:f(this.homeUrl),tar_uri:"/"},window.rapidInstance.beaconClick("hl-viewer","desktop"===this.config.device?"close":"close-back-btn",0,i,"",void 0,{dwell:"stop"}),window.YAHOO&&window.YAHOO.i13n&&(window.YAHOO.i13n.SPACEID=parseInt(t,10)),window.rapidInstance.clearRapidAttribute(["keys"]),window.rapidInstance.setRapidAttribute({keys:Object.assign({},this.keys,e),spaceid:t}),window.rapidInstance.beaconPageview(e)}async onContentWillChange(t){this.refererUrl=t.refererUrl}async beacon(t){await this.beaconDwellStop(),this.beaconModalContent(t)}updateRapidAttributes(t){var e;if(!window.rapidInstance)return;const{elem:i,meta:{data:n}}=t,{adMeta:s,contentType:o,canonicalUrl:a,hostedType:r,previewLink:c,publisher:d,spaceId:l,url:h,uuid:w}=n,u="hosted"===r;this.articleUrl=!u&&c||h||a;const p={_R:this.refererUrl||this.homeUrl,_w:this.articleUrl,navtype:"client",p_cpos:I(t.elem),p_hosted:u?"onnet":"offnet",pcp:d,pct:N[o]||o,pd:"modal",prefcnt:this.config.clusterSize+1,pstaid:w,pt:"content",rspns:"nav",site:(null==s?void 0:s.site)||this.keys.site,slk:t.meta.data.title};"mainArticle"!==i.id&&(p.expn="perpetual-post"),null===(e=window.rapidInstance)||void 0===e||e.setRapidAttribute({keys:p,spaceid:l}),window.YAHOO&&window.YAHOO.i13n&&(window.YAHOO.i13n.SPACEID=parseInt(l,10))}beaconModalContent(t){var e,i;if(!window.rapidInstance)return;const{elem:{id:n}}=t;this.updateRapidAttributes(t),window.rapidInstance.beaconPageview(),window.rapidInstance.isModuleTracked(n)?window.rapidInstance.refreshModule(n,!1,!0):window.rapidInstance.addModules(n,!1,{setViewability:!0}),null===(e=(i=window.rapidInstance).addModuleProgression)||void 0===e||e.call(i,n)}async beaconDwellStop(){return new Promise((t=>{window.rapidInstance&&window.rapidInstance.beaconClick("rapidDwell","",0,{},"",t,{dwell:"stop"})}))}onSlideshowClick(t){if(!window.rapidInstance)return;const{pos:e,ylk:i}=t.payload;window.rapidInstance.beaconClick("sshow",i.slk,e,i,i.outcm,void 0,{dwell:"stop"}),window.rapidInstance.beaconPageview({pct:"slideshow"})}onLinkClick(t){if(!window.rapidInstance)return;const{pos:e,ylk:i}=t.payload,{sec:n="content-canvas"}=i;window.rapidInstance.beaconClick(n,i.slk,e,i,i.outcm)}}({clusterSize:2,device:"desktop"}),new class{constructor(){this.event="homepage-viewer",this.viewportEvent="homepage-viewer-viewport",this.onScrollHandle=null,this.viewportAdPositions=[],this.viewportAdFetchSlotIndex=[],this.viewportPreviousAdFetchSlotIndex=[],this.pageContext={},this.perArticleAdPositions=[]}init(t){var e,i;if(t&&(this.site=t.context.site||"fp"),this.pageContext=S()||{},window.adsConfig)this.config=window.adsConfig;else{(new Image).src=`/${g(this.site)}?error=no_ads_config`}this.rotateIndexPageAds=(null==t||null===(e=t.ads)||void 0===e?void 0:e.rotateIndexPageAds)||!1,this.perArticleRREnabled=(null===(i=t.rightRail)||void 0===i?void 0:i.disableSidekick)||!1,window.wafer.on("caas:article:init",this.displayAds.bind(this)),window.wafer.on("caas:article:init",this.setWaferState.bind(this)),this.perArticleRREnabled&&window.wafer.on("caas:article:inview",this.fetchPerArticleAds.bind(this))}onClick(t){"slideshow"===t.type&&window.DARLA&&!window.DARLA.inProgress()&&window.DARLA.event("slideshow")}getAdBlockConfig(){var t,e,i,n;if(!this.config)return;const s=JSON.parse(JSON.stringify(this.config));let o=s.viewerPositionMeta.positions;const a=(null===(t=s.strings)||void 0===t?void 0:t.advertisement)||"Advertisement";null!==(e=s.viewerViewportAdFetch)&&void 0!==e&&e.slots&&null!==(i=s.viewerViewportAdFetch.slots[0])&&void 0!==i&&null!==(n=i.positions)&&void 0!==n&&n.length&&(s.viewerViewportAdFetch.slots.forEach((t=>{var e;null!==(e=t.positions)&&void 0!==e&&e.length&&(o=o.concat(t.positions))})),s.viewerViewportAdFetch.slots=[]),s.viewerPositionMeta.positions=o.filter((t=>{var e;return null!==(e=s.viewerPositionMeta)&&void 0!==e&&e.enableUBAMON?!(t.id.startsWith("INARTICLE")||t.id.startsWith("MAST")||t.id.startsWith("FSRVY")||t.id.startsWith("LREC4")):!(t.id.startsWith("INARTICLE")||t.id.startsWith("MAST")||t.id.startsWith("MON")||t.id.startsWith("MON2")||t.id.startsWith("FSRVY")||t.id.startsWith("LREC4"))}));for(const t of s.viewerPositionMeta.positions){const e=document.getElementById(t.clean),i=document.getElementById(t.dest);if(e&&e.parentNode&&i){var r,c,d;t.id="UBA"+t.id,t.clean=null==t||null===(r=t.clean)||void 0===r?void 0:r.replace("-","-UBA"),t.dest=null==t||null===(c=t.dest)||void 0===c?void 0:c.replace("-","-UBA");const n=document.createElement("div");if(n.id="viewer-"+t.id+"-base",n.style.width="100%",n.className="uba-container",e.id=t.clean,i.id=t.dest,e.parentNode.insertBefore(n,e),n.appendChild(e),null===(d=s.viewerPositionMeta)||void 0===d||!d.enableUBAMON){const i=document.createElement("span");i.innerText=a,i.style.color="#787d82",i.style.display="block",i.style.fontSize="11px",i.style.marginBottom="3px",i.style.marginLeft="auto",i.style.marginRight="auto",t.id.indexOf("LDRB")>=0?i.style.width="728px":i.style.width="100%",n.insertBefore(i,e)}}}return s}getConfig(){return document.cookie.includes("thamba=2")?this.getAdBlockConfig():this.config}onViewerClosed(){var t,e,i,n;(window.DARLA&&window.DARLA.inProgress()&&window.DARLA.abort(),this.onScrollHandle&&(window.wafer.removeListener("scroll",this.onScrollHandle),this.onScrollHandle=null),null!==(t=this.config)&&void 0!==t&&t.viewerResetAutoEventOnClose&&null!==(e=this.darlaAutoEvent)&&void 0!==e&&e.ps)&&(null===(i=window.DARLA)||void 0===i||i.add(E,this.darlaAutoEvent));this.rotateIndexPageAds&&(null===(n=window.DARLA)||void 0===n||n.event("adFetch"))}addPosition(t){const e=[];let i=window.location.protocol+"//"+window.location.host;window.location.pathname&&(i+=window.location.pathname);for(const n of t)e.push(n.id),n.meta||(n.meta={}),n.meta.hostURL=i,window.DARLA.addPos(n);return e}addViewportDarlaEvent(t){var e;null===(e=window.DARLA)||void 0===e||e.add(this.viewportEvent,{name:this.viewportEvent,ps:t.join(","),ref:window.location.href,sa:this.siteAttribute,sp:this.spaceId})}fetchPerArticleAds(t){if(window.DARLA&&(this.getPerArticleAdPositions(t),this.perArticleAdPositions.length)){var e,i,n;const s=null==t||null===(e=t.meta)||void 0===e?void 0:e.data,o=null==s?void 0:s.adMeta;this.spaceId=null==o?void 0:o.spaceid;const a=(null==o?void 0:o.site_attribute)||"";null!==(i=this.config)&&void 0!==i&&null!==(n=i.viewerPositionMeta)&&void 0!==n&&n.siteAttributes&&(this.siteAttribute=a+" "+this.config.viewerPositionMeta.siteAttributes),window.DARLA.inProgress()?this.delayFetchAds(this.displayPerArticleAds,20):this.displayPerArticleAds()}}displayAds(t){var e,i,n;const s=this.getConfig();if(!window.DARLA||!s)return;window.DARLA.inProgress()&&window.DARLA.abort(),this.contentSite=t.meta.data.adMeta&&t.meta.data.adMeta.site||"",this.spaceId=t.meta.data.spaceId;let o=[],a=t.meta.data.adMeta&&t.meta.data.adMeta.site_attribute||"";const r=this.pageContext.bucket||this.pageContext.bucketId,c=r?"Y-BUCKET="+r:"";a.indexOf("page_template")<0&&(a+=" page_template=modal"),this.siteAttribute=s.viewerPositionMeta.siteAttributes+" "+a+" "+c;const d=JSON.parse(JSON.stringify(s.viewerPositionMeta.positions));let l=[];if(s.viewerPositionMeta&&(l=this.addPosition(d)),null!==(e=s.viewerViewportAdFetch)&&void 0!==e&&e.slots&&null!==(i=s.viewerViewportAdFetch.slots[0])&&void 0!==i&&null!==(n=i.positions)&&void 0!==n&&n.length&&(this.viewportAdPositions=s.viewerViewportAdFetch.slots.map((t=>({...t,fetched:!1}))),this.viewportAdPositions.forEach((t=>{o=o.concat(this.addPosition(t.positions))}))),this.isViewportAdFetchEnabled()&&o.length?(this.onScrollHandle=this.handleScrollEvent.bind(this),window.wafer.on("scroll",this.onScrollHandle)):l=l.concat(o),window.DARLA.add(this.event,{name:this.event,ps:l.join(","),ref:window.location.href,sa:this.siteAttribute,sp:this.spaceId,ult:k(this.contentSite)}),window.DARLA.add("slideshow",{name:"slideshow",ps:s.viewerPositionMeta.slideshowPositions,ref:window.location.href,sa:this.siteAttribute,sp:this.spaceId,ult:k(this.contentSite)}),!document.cookie.includes("thamba=2")){window.DARLA.stopAuto();const t={autoDDG:1,autoIV:1,autoMax:25,autoRT:1e4,autoStart:1,name:E,ps:l.concat(o).reduce(((t,e)=>(V.includes(e)||(t[e]={autoIV:1,autoMax:25,autoRT:1e4}),t)),{}),ref:window.location.href,sa:this.siteAttribute,sp:this.spaceId,ult:k(this.contentSite)};this.config.viewerPositionMeta.groupRotation&&(t.groups=this.config.viewerPositionMeta.groupRotation),this.darlaAutoEvent=window.DARLA.evtSettings(E),window.DARLA.add(E,t),window.DARLA.startAuto()}window.DARLA.event(this.event)}getPerArticleAdPositions(t){const{elem:e,meta:{data:{uuid:i=""}={}}={}}=t,n=I(e);if(!n||n<2||n>3)return;const s=[],o=e.querySelector(`#caas-art-${i} #viewer-LREC-iframe`),a=1===n?"":`-${n}`;o&&o.parentElement&&(o.parentElement.id=`viewer-LREC${a}`,o.id=`viewer-LREC${a}-iframe`,s.push(`LREC-${n}`));const r=e.querySelector(`#caas-art-${i} #viewer-LREC2-iframe`);r&&r.parentElement&&(r.parentElement.id=`viewer-LREC2${a}`,r.id=`viewer-LREC2${a}-iframe`,s.push(`LREC2-${n}`)),this.perArticleAdPositions=s}displayPerArticleAds(){var t;if(window.DARLA&&null!==(t=this.perArticleAdPositions)&&void 0!==t&&t.length){var e,i;const t=null===(e=this.config)||void 0===e||null===(i=e.viewerPositionMeta)||void 0===i?void 0:i.positions.filter((t=>-1!==this.perArticleAdPositions.indexOf(t.id))),n=[];let s=window.location.protocol+"//"+window.location.host;if(window.location.pathname&&(s+=window.location.pathname),null!=t&&t.length){for(const e of t)n.push(e.id),e.meta||(e.meta={}),e.meta.hostURL=s,window.DARLA.addPos(e);window.DARLA.add(this.event,{name:this.event,ps:this.perArticleAdPositions,ref:window.location.href,sa:this.siteAttribute,sp:this.spaceId}),window.DARLA.event(this.event)}}}setWaferState(t){const{adMeta:e,spaceId:i}=t.meta.data,n=function(t){if(t){const e=t.match(h);if(e.length>=2){const t={},i=e[1].split(";");for(let e of i)e=e.split(":"),e.length>=2&&w[e[0]]&&(t[w[e[0]]]=e[1]);return t}}return null}(e.site_attribute),s=JSON.stringify(n);window.wafer.state={publisherBlobPageContext:encodeURIComponent(s),viewerMainArticlePubBlob:s.replace(/\"/g,'\\"'),viewerMainArticleSpaceId:parseInt(i,10)}}getPendingViewportAdSlotIndex(){const t=[];return this.viewportAdPositions.forEach(((e,i)=>{e.fetched||t.push(i)})),t}getPositionsAndMarkSlot(){let t=[];return this.viewportAdFetchSlotIndex.forEach((e=>{var i,n,s;null!==(i=this.viewportAdPositions[e])&&void 0!==i&&null!==(n=i.positions)&&void 0!==n&&n.length&&(t=t.concat(null===(s=this.viewportAdPositions[e])||void 0===s?void 0:s.positions.map((t=>t.id))),this.viewportAdPositions[e].fetched=!0)})),t}isViewportAdFetchEnabled(t=!0){var e,i,n;const s=this.config;if(!this.contentSite||!s||t&&document.cookie.includes("thamba=2"))return!1;if(null!==(e=s.viewerViewportAdFetch)&&void 0!==e&&e.slots&&null!==(i=s.viewerViewportAdFetch.slots[0])&&void 0!==i&&null!==(n=i.positions)&&void 0!==n&&n.length){var o;return-1!==((null===(o=s.viewerViewportAdFetch)||void 0===o?void 0:o.sites)||[]).indexOf(this.contentSite)}return!1}isAdPositionsInViewport(t){let e=!1;return t.forEach((t=>{const i=document.getElementById(t.clean);!e&&i&&(e=window.wafer.utils.elementInView(i,{},window.wafer.base.viewport))})),e}isSlotPositionsInViewport(t){let e=!1;return t.forEach((t=>{var i;const n=null===(i=this.viewportAdPositions[t])||void 0===i?void 0:i.positions,s=n&&this.isAdPositionsInViewport(n);s&&!this.viewportAdFetchSlotIndex.includes(t)&&this.viewportAdFetchSlotIndex.push(t),!e&&s&&(e=!0)})),e}displayViewportAds(){if(window.DARLA){const t=window.DARLA.evtSettings(this.event),e=this.getPositionsAndMarkSlot();if(!e.length)return;t&&(t.ps=`${t.ps},${e.join(",")}`,window.DARLA.add(this.event,t)),this.addViewportDarlaEvent(e),this.viewportPreviousAdFetchSlotIndex=this.viewportAdFetchSlotIndex,this.viewportAdFetchSlotIndex=[],window.DARLA.event(this.viewportEvent)}}delayFetchAds(t,e=2){if(!t)return;let i=1;const n=setInterval((()=>{var s;i>e?(clearInterval(n),null!==(s=window.DARLA)&&void 0!==s&&s.inProgress()&&(window.DARLA.abort(),t())):window.DARLA&&!window.DARLA.inProgress()&&(clearInterval(n),t());i++}),500)}onScrollViewportFetch(){var t;const e=this.getPendingViewportAdSlotIndex();if(this.onScrollHandle&&!e.length&&(window.wafer.removeListener("scroll",this.onScrollHandle),this.onScrollHandle=null),!this.isSlotPositionsInViewport(e))return;const i=null===(t=window.DARLA)||void 0===t?void 0:t.inProgress();var n;i?i!==this.event?(null===(n=window.DARLA)||void 0===n||n.abort(),i===this.viewportEvent&&this.viewportPreviousAdFetchSlotIndex.length&&(this.viewportPreviousAdFetchSlotIndex.forEach((t=>{this.viewportAdFetchSlotIndex.includes(t)||this.viewportAdFetchSlotIndex.push(t)})),this.viewportPreviousAdFetchSlotIndex=[]),this.displayViewportAds()):this.delayFetchAds(this.displayViewportAds):(this.viewportPreviousAdFetchSlotIndex=[],this.displayViewportAds())}handleScrollEvent(){"function"==typeof requestAnimationFrame?(this.scrollAnimationFrameTimer&&cancelAnimationFrame(this.scrollAnimationFrameTimer),this.scrollAnimationFrameTimer=requestAnimationFrame((()=>{this.onScrollViewportFetch()}))):this.onScrollViewportFetch()}},new class{constructor(){this.pageContainer="atomic",this.viewerContainer="viewer",this.aft2MaxWaitTime=6e3}init(t){null!=t&&t.yaft&&(t.yaft.pageContainer&&(this.pageContainer=t.yaft.pageContainer),t.yaft.viewerContainer&&(this.viewerContainer=t.yaft.viewerContainer),t.yaft.aft2MaxWaitTime&&(this.aft2MaxWaitTime=t.yaft.aft2MaxWaitTime))}onViewerOpened(){this.onTransitionStart(this.viewerContainer)}onContentChange(){this.onTransitionRenderStart()}onViewerClosed(){this.onTransitionStart(this.pageContainer)}onViewerDidClose(){this.onTransitionRenderStart()}onTransitionStart(t){const{YAFT:e}=window;e&&e.AFT2&&(e.AFT2.start(),e.updateConfig({maxWaitTime:this.aft2MaxWaitTime,modulesAft2Container:t}),e.adPosLoadTimes=[])}onTransitionRenderStart(){const{rapidInstance:t,YAFT:e}=window;t&&e&&e.AFT2&&e.AFT2.end(((e,i)=>{if(i)return;const n=Math.round(e.aft),s=e.visuallyComplete,o={perf_commontime:{afterPageLoad:{AFT:n,AFT2:n,STR:Math.round(e.startRender),VIC:s}}};t.beaconPerformanceData(o)}))}},new class{constructor(){var t;this.logCaasEvent=t=>{window.wafer.on(t,(e=>{const i=e&&e.meta||{},n=`/${this.infoBeaconUri}?error=${t}&meta=${JSON.stringify(i)}`;window.wafer.utils.fireBeacon(n,{useNavigator:!1,useTimestamp:!1})}))};const{apptype:e,bucket:i,rid:n}=(null===(t=window.YAHOO)||void 0===t?void 0:t.context)??{};this.context={apptype:e,bucket:i,client:"1",rid:n}}init(t){t&&(this.site=t.context.site||"fp"),this.infoBeaconUri=g(this.site);const e=this.beaconPageView.bind(this);window.wafer.on("caas:article:inview",e),window.wafer.on("caas:article:init",e),window.wafer.on("log",this.beaconLog.bind(this)),this.logCaasEvent("caas:prefetch:failed")}onClick(t){"article"===t.type&&(this.uuid=t.payload.uuid,this.t0=Date.now())}async onContentWillChange(){this.t1=Date.now()}async onContentChange(){this.t2=Date.now()}async onContentDidChange(){this.t3=Date.now(),this.beaconClk2Cnt()}onViewerOpened(){this.beacon({beaconType:"homepage_viewer",info:"show_viewer"})}onViewerClosed(){this.beacon({beaconType:"homepage_viewer",info:"close_viewer"})}beaconLog({meta:t,name:e,type:i}={}){if("WaferCaas"===e||"BrowserType"===e&&t.slow){const e=`/${this.infoBeaconUri}?error=log&meta=${JSON.stringify(t)}`;window.wafer.utils.fireBeacon(e,{useNavigator:!1,useTimestamp:!1})}}beaconPageView(t){var e;const i=new Image,n=new URL("/pageview",window.location.origin),s=null===(e=t.meta.data.adMeta)||void 0===e?void 0:e.site;n.search=v({...this.context,property:s}),i.src=n.toString()}beaconClk2Cnt(){this.beacon({code:"homepage_viewer_clk2cnt",t0:this.t0,t1_t0:Math.floor(this.t1-this.t0),t2_t1:Math.floor(this.t2-this.t1),t3_t2:Math.floor(this.t3-this.t2),time:Math.floor(this.t3-this.t0),uuid:this.uuid})}beacon(t){(new Image).src=`/${this.infoBeaconUri}?${v(t)}`}},new class{constructor(t){this.className=t.targetClassName,this.closeButton=document.getElementById("closebtn"),this.clusters=[],this.clusterSize=t.clusterSize,this.headerAnchorId="",this.home=new URL(location.href),this.isViewerClosed=!0,this.ntkClusterSize=t.ntkClusterSize,this.tagName=t.targetTagName,this.site="fp"}init(t){var e;null!=t&&null!==(e=t.clickHandler)&&void 0!==e&&e.clusterSize&&(this.clusterSize=t.clickHandler.clusterSize),t&&(this.site=t.context.site);const i=this.handleClick.bind(this);let n=document.getElementById("header-logo");n?this.headerAnchorId="header-logo":(n=document.getElementById("ybar-logo"),n&&(this.headerAnchorId="ybar-logo"));const s=this.handleCaaSClickLink.bind(this);document.body.addEventListener("click",i,{capture:!0}),window.wafer.on("caas:link:clicked",s),window.wafer.on("caas:yahooLink:clicked",s),this.viewerNode=document.getElementById("viewer")}getArticles(t,e){const i={},n=t.querySelectorAll("[data-wf-caas-uuid]");for(const t of n){const n=t.getAttribute("data-wf-caas-uuid");if(n===e)continue;const s=t.getAttribute("href")||"",o=m(s);n&&o&&(i[n]={pathname:o,uuid:n})}return i}onViewerClosed(){this.clusters=[],this.isViewerClosed=!0}onViewerWillOpen(){this.home=new URL(location.href)}onViewerOpened(){this.isViewerClosed=!1;var t=this;setTimeout((function(){var e;t.closeButton=t.closeButton||document.getElementById("closebtn"),null===(e=t.closeButton)||void 0===e||e.focus()}),500)}getElementComposedMap(t){let e=t;const i=new Map;for(;e;)i.set(e,!0),e=e.parentElement;return i}getClusterSize(t){return 0===Math.max(this.clusterSize,this.ntkClusterSize)?0:p(t,{className:"ntktdv2"})?this.ntkClusterSize:p(t,{className:"yns-notifications"})?0:this.clusterSize}handleCaaSClickLink(t){const i=t.meta.data;if(i.isComment){const t=i.uuid;return this.dispatch(e,{payload:{uuid:t},type:"comments"})}const{sec:n}=i;if(i.href){const{pos:t,slk:s}=i;return this.dispatch(e,{payload:{pos:t,ylk:Object.assign({sec:n,slk:s},i.params)},type:"link"}),void(window.open(i.href,i.target).opener=null)}if("sshow"===n){const{pos:t,sec:n,slk:s}=i;this.dispatch(e,{payload:{pos:t,ylk:Object.assign({sec:n,slk:s},i.params)},type:"slideshow"})}}handleClick(t){if(!C(window,"wafer.wafers.wafer-caas"))return;const i=t.target,n=i&&i.id;if(!this.isViewerClosed){if(p(i,{id:"header-back-button",tagName:"A"}))return t.preventDefault(),t.stopPropagation(),this.dispatch(e,{type:"back"});const s=this.headerAnchorId&&p(i,{id:this.headerAnchorId,tagName:"A"});if(s){const i=m(s.href);if(this.home.pathname!==i)return;return t.preventDefault(),t.stopPropagation(),this.dispatch(e,{type:"close"})}if(p(i,{id:"closebtn",tagName:"BUTTON"}))return this.dispatch(e,{type:"close"});if("Overlay"===n)return this.dispatch(e,{type:"overlay"})}const s=p(i,{className:this.className,tagName:this.tagName});if(s){if(t.ctrlKey||t.metaKey)return;"function"==typeof t.preventDefault&&t.preventDefault();const i=!!p(t.target,{className:"js-stream-comments-button"}),n=s.getAttribute("href")||"",o=!!window.MSInputMethodContext&&!!document.documentMode,a=window.React;if(o&&a&&("finance"===this.site||"sports"===this.site))return void(window.location.href=n);const r=m(n),c=this.getClusterArticles(s),d=A(s),l={cluster:c,expandComments:i,isHpViewer:!0,pathname:r,refererUrl:window.location.href,uuid:d};this.dispatch(e,{payload:l,type:"article"})}const o=this.getElementComposedMap(i);if(this.viewerNode&&o.has(this.viewerNode)){const t=document.getElementById("content-viewer");if(t&&!o.has(t))return this.dispatch(e,{type:"close"});const i=this.viewerNode.getElementsByClassName("viewer-wrapper")[0];if(i&&!o.has(i))return this.dispatch(e,{type:"close"})}}getClusterArticles(t){const e=this.getClusterSize(t);if(0===e)return[];const i=p(t,{className:"article-cluster-boundary"})||p(t,{className:"drawer-fetch-target",tagName:"DIV"})||p(t,{className:"stream-item",tagName:"LI"})||p(t,{className:"js-stream-content",tagName:"LI"})||p(t,{className:"tdv2-wafer-ntk-desktop",tagName:"DIV"})||p(t,{className:"aside-sticky",tagName:"DIV"})||p(t,{id:"Page"});if(!i)return[];let n=t.getAttribute("data-wf-caas-uuid")||t.getAttribute("data-uuid")||"";if(!n){const e=p(t,{className:"js-stream-content",tagName:"LI"});n=e&&(e.getAttribute("data-wf-caas-uuid")||e.getAttribute("data-uuid"))||""}const s=this.getArticles(i,n);let o=i.nextElementSibling;for(;Object.keys(s).length<e&&o;)Object.assign(s,this.getArticles(o,n)),o=o.nextElementSibling;let a=i.previousElementSibling;for(;Object.keys(s).length<e&&a;)Object.assign(s,this.getArticles(a,n)),a=a.previousElementSibling;return this.clusters=Object.values(s).slice(0,e),this.clusters}}({clusterSize:2,ntkClusterSize:5,targetClassName:"js-content-viewer",targetTagName:"A"}),new class{constructor(){this.home=new URL(location.href),this.c2sSessionId="",this.c2sArticleIndex=0,this.c2sElements=[],this.onScroll=null}init(t){t&&(this.site=t.context.site||"fp"),this.infoBeaconUri=g(this.site),window.adsConfig&&(this.config=window.adsConfig),this.config&&this.config.viewerPositionMeta&&this.config.viewerPositionMeta.c2siframe&&(window.wafer.on("caas:article:init",this.articleInit.bind(this)),window.wafer.on("caas:article:inview",this.articleInview.bind(this)))}onViewerWillOpen(){this.home=new URL(location.href)}onViewerClosed(){this.onScroll&&(window.removeEventListener("scroll",this.onScroll),this.onScroll=null)}articleInit(t){this.config.viewerPositionMeta.c2siframe&&this.config.viewerPositionMeta.c2siframe.sites.indexOf(t.meta.data.adMeta.site)>=0&&(this.c2sSessionId=Date.now()+"_"+Math.random().toString().substr(2,5),this.c2sArticleIndex=0,this.c2sElements=[])}articleInview(t){this.c2sArticleIndex++;const e="qa5.www.yahoo.com"===this.home.host&&this.home.searchParams.has("c2sallowall");t.elem&&t.elem.querySelector&&t.elem.querySelector(".js-c2smodule")||this.config.viewerPositionMeta.c2siframe&&(e||t.meta&&t.meta.data&&t.meta.data.adMeta.site&&this.config.viewerPositionMeta.c2siframe.sites.indexOf(t.meta.data.adMeta.site)>=0)&&this.loadC2siframe(t)}loadC2siframe(t){const e=t.elem.querySelector(".caas-body");if(e){const i=document.createElement("iframe");i.setAttribute("class","js-c2smodule"),i.setAttribute("frameborder","no"),i.setAttribute("scrolling","no"),i.setAttribute("allowtransparency","true"),i.setAttribute("async","true"),i.setAttribute("tabindex","-1"),i.style.marginTop="20px",i.style.width="100%";const n=t.meta.data.uuid,s=new URL(this.config.viewerPositionMeta.c2siframe.url);s.searchParams.append("uuid",n),s.searchParams.append("sid",String(this.c2sSessionId)),s.searchParams.append("iid",String(this.c2sArticleIndex)),i.setAttribute("src",s.href);const o=Date.now(),a=setTimeout((()=>{i.style.display="none",window.wafer.utils.fireBeacon("/"+this.infoBeaconUri+"?type=c2siframe-timedout&uuid="+n,{useNavigator:!1,useTimestamp:!1})}),this.config.viewerPositionMeta.c2siframe.timeout||5e3);i.addEventListener("load",this.handleOnload.bind(this,n,a,o),!1),window.addEventListener("message",this.handlePostMessage.bind(this,n,i),!1),e.appendChild(i),this.c2sElements.push(i),!this.onScroll&&i.contentWindow&&i.contentWindow.postMessage&&(this.onScroll=this.handleScroll.bind(this),"function"==typeof requestAnimationFrame?window.wafer.on("scroll",(()=>requestAnimationFrame(this.onScroll))):window.wafer.on("scroll",this.onScroll))}}handleOnload(t,e,i){clearTimeout(e),window.wafer.utils.fireBeacon("/"+this.infoBeaconUri+"?type=c2siframe-loaded&uuid="+t+"&latency="+(Date.now()-i),{useNavigator:!1,useTimestamp:!1})}handlePostMessage(t,e,i){if(!t||!e)return;const n=i;if(n.data&&"c2sDisplay"===n.data.event&&n.data.articleId===t){const s=n.data.terms||[];n.data.height&&(e.style.height=n.data.height+"px"),window.wafer.utils.fireBeacon("/"+this.infoBeaconUri+"?type=c2siframe-renderd-searchitems&uuid="+t+"&widget="+escape(i.data.widget)+"&flavor="+escape(i.data.flavor||"")+"&count="+s.length+"&terms="+escape(JSON.stringify(s)),{useNavigator:!1,useTimestamp:!1})}}handleScroll(){this.c2sElements.forEach((t=>{window.wafer.utils.elementInView(t,{},window.wafer.base.viewport)?t.contentWindow.postMessage("c2s-node-visible","*"):t.contentWindow.postMessage("c2s-node-not-visible","*")}))}},new class{constructor(t){this.isEnabled=!0;const e=S();this.comments={},this.config=t,this.expanded=!1,this.region=(null==e?void 0:e.region)||"US",this.lang=(null==e?void 0:e.lang)||"en-US",this.site="fp"}init(t){var e;const i=document.getElementById("spotim-config"),n=i&&window.wafer.utils.getConfigFromJSONScriptNode(i)||{};if(null!=t&&null!==(e=t.spotIm)&&void 0!==e&&e.enabled||null!=n&&n.enabled)return void(this.isEnabled=!1);t&&(this.region=t.context.region,this.lang=t.context.lang,this.site=t.context.site);const s=this.initCommentsOnView.bind(this);window.wafer.on("caas:article:inview",s),window.wafer.on("caas:article:init",s)}async onContentChange(t){this.expanded=t.expandComments}async onClick(t){if(this.isEnabled&&"comments"===t.type){const e=t.payload.uuid,i=this.comments[e]||await this.initCommentsOnClick(e);if(i&&i.instance){i.instance.expand(),await u(100);document.getElementById(i.id).scrollIntoView({behavior:"smooth"})}}}onViewerDidClose(){Object.values(this.comments).forEach((t=>{var e;null===(e=t.instance)||void 0===e||e.destroy()})),this.comments={},this.expanded=!1}getCommentsNodeId(t){const e=window.wafer.base._state;for(const i of Object.getOwnPropertyNames(e)){if(e[i]===t){const t=document.querySelector(`[data-wf-state-caas-uuid="[state.${i}]"]`);if(t){return t.getAttribute("data-comments-id")}}}}getRapidBucket(){var t,e;return(null===(t=window.rapidPageConfig)||void 0===t||null===(e=t.rapidConfig)||void 0===e?void 0:e.test_id)||""}getRapidKeys(){return window.rapidInstance?window.rapidInstance.getRapidAttribute("keys"):{}}getRapidSpaceId(){return window.rapidInstance?window.rapidInstance.getRapidAttribute("spaceid"):""}getCanvassCommentsParams(t){const{commentSectionId:e,hostedType:i,spaceId:n,title:s,url:o,uuid:a}=t,r="hosted"===i?"yahoo_content":"yahoo_offnet",c=this.getRapidKeys(),d=n||this.getRapidSpaceId(),{_rid:l,site:h="fp"}=c,{device:w}=this.config,u="news"===this.site?"redesign":"",p="news"===this.site?"Ff(YahooSans)":"";return{bucket:this.getRapidBucket(),context:a,contextDisplayText:s,contextUrl:o,device:w,lang:this.lang,namespace:r,prid:l,rapid:window.rapidInstance,rapidKeys:c,region:this.region,sectionId:e,site:h,spaceid:d,theme:u,themeContainerClasses:p,useRelativeHostName:!0}}initComments(t,e,i){const{CanvassComments:n}=window.YAHOO,{rmp:s}=this.config;if(!s){if(!n)return;const s=new n(e,i);return this.expanded=!1,this.comments[t]={id:e,instance:s}}{const n=document.getElementById(e);if(!n)return;this.comments[t]={id:e};const o=`${s.xhrPathPrefix}?m_id=${s.m_id}&ctrl=${s.ctrl}&m_mode=json&rid=${i.prid}&context=${t}&device=${i.device}&site=${i.site}&region=${i.region}&lang=${i.lang}`,a=s.config?`data-wf-body=${JSON.stringify(s)}`:"";n.innerHTML=`<div class="wafer-fetch" data-wf-trigger="onLoad" data-wf-cache-strategy="cacheFirst" data-wf-replace="1" data-wf-url="${o}" ${a}></div>`,window.wafer.base.sync(n)}}initCommentsOnView(t){if(window.YAHOO){const e=t.meta.data,i=e.uuid;if(!e.commentsAllowed)return;if(this.comments[i])return;const n=t.elem.getAttribute("data-comments-id"),s=this.getCanvassCommentsParams(e);s.expanded=this.expanded,this.initComments(i,n,s)}}async initCommentsOnClick(t){const[e]=await window.wafer.caas.getData([t]);if(!e.commentsAllowed)return;const i=this.getCanvassCommentsParams(e);i.expanded=!0;const n=this.getCommentsNodeId(t);return n?this.initComments(t,n,i):void 0}}({device:"desktop",rmp:{config:{ui:{enableFeedback:!1}},ctrl:"CanvassMessage",m_id:"tdv2-applet-canvass.message",m_mode:"json",xhrPathPrefix:"/nel_ms/_td/remote"}}),new class{onViewerDidClose(){dispatchEvent(new CustomEvent("viewerClosed"))}onViewerOpened(t){const e={detail:{uuid:t.uuid}};dispatchEvent(new CustomEvent("viewerOpened",e))}onContentChange(t){const e={detail:{uuid:t.uuid}};dispatchEvent(new CustomEvent("viewerContentChanged",e))}},new class{init(){this.shouldDeeplink=!document.getElementById("content-viewer-template")}onClick(t){var e;this.shouldDeeplink&&"article"===t.type&&null!==(e=t.payload)&&void 0!==e&&e.pathname&&(window.location.pathname=t.payload.pathname)}},new class{init(t){var e;this.mainView=document.getElementById("Masterwrap")||document.getElementById("MainView")||(null===(e=document.getElementById("YDC-Col1"))||void 0===e?void 0:e.parentElement),this.viewer=document.getElementById("content-viewer"),this.viewerParent=document.getElementById("viewer"),this.listener=t=>{27===t.keyCode&&history.back()},null!=t&&t.enableFanShopModal&&window.wafer.on("caas:article:init",this.setWaferState.bind(this))}onContentWillChange(){window.wafer.state={showViewer:Date.now()}}setWaferState(t){const e=t.meta.data.entities||{};window.wafer.state={contentEntities:JSON.stringify(e).replace(/\"/g,'\\"')}}async onContentChange(t){const{cluster:e=[],expandComments:i,uuid:n}=t,s=e.map((t=>t.uuid)),o=i?"1":"0";this.viewer.classList.remove(...[0,1,2,3,4,5,6].map((t=>`cluster${t}`))),this.viewer.classList.add(`cluster${e.length}`),await u(1),window.wafer.state={viewerClusterArticleId1:s[0],viewerClusterArticleId2:s[1],viewerClusterArticleId3:s[2],viewerClusterArticleId4:s[3],viewerClusterArticleId5:s[4],viewerClusterArticleId6:s[5],viewerMainArticleCollapsed:o,viewerMainArticleId:n},await u(1)}async onViewerOpened(){var t;window.wafer.base.lock(this.mainView);const{left:e,top:i}=this.mainView.getBoundingClientRect();this.mainView.setAttribute("aria-hidden","true"),Object.assign(this.mainView.style,{left:e+"px",position:"fixed",top:i+"px",visibility:"hidden"}),null===(t=this.viewerParent)||void 0===t||t.setAttribute("aria-hidden","false"),document.documentElement.classList.add("modal-open","Panel-open","viewer-open"),await u(5),window.addEventListener("keydown",this.listener)}onViewerClosed(){var t;null===(t=this.viewerParent)||void 0===t||t.setAttribute("aria-hidden","true"),this.mainView.style.visibility="",this.viewer.classList.remove("wafer-template-success"),window.wafer.base.destroy(this.viewer),this.viewer.innerHTML="",document.documentElement.classList.remove("modal-open","Panel-open","viewer-open"),this.mainView.removeAttribute("aria-hidden"),Object.assign(this.mainView.style,{left:"",position:"",top:""}),window.wafer.base.unlock(this.mainView),window.wafer.base.sync(this.mainView),window.removeEventListener("keydown",this.listener),window.wafer.state={showViewer:"wf-state-reset",viewerClusterArticleId1:"wf-state-reset",viewerClusterArticleId2:"wf-state-reset",viewerClusterArticleId3:"wf-state-reset",viewerClusterArticleId4:"wf-state-reset",viewerClusterArticleId5:"wf-state-reset",viewerClusterArticleId6:"wf-state-reset",viewerMainArticleCollapsed:"wf-state-reset",viewerMainArticleId:"wf-state-reset",viewerMainArticlePubBlob:"wf-state-reset"}}},new class{constructor(){this.count="12",this.sidekickUrl=this.getSidekickUrl(),this.clusterUuids=[]}init(t){var e;if(null!==(e=t.rightRail)&&void 0!==e&&e.disableSidekick)return;const i=this.initSidekick.bind(this);window.wafer.on("caas:article:init",i)}async onContentChange(t){window.wafer.state={sidekick:"wf-state-reset"};const{cluster:e=[]}=t;this.clusterUuids=[];for(const t of e)t.uuid&&this.clusterUuids.push(t.uuid)}onViewerClosed(){window.wafer.state={sidekick:"wf-state-reset"}}isLongArticle(t){return"hosted"===t.hostedType&&"slideshow"!==t.contentType&&"video"!==t.contentType}getSidekickUrl(){const t=b()?location.origin:"https://www.yahoo.com",e=new URL(t);return e.pathname="/caas/sidekick/sidekick",e}initSidekick(t){const{spaceId:e,uuid:i,ycts:n}=t.meta.data;let s=i;(async()=>{const t=await window.wafer.caas.getData([i,...this.clusterUuids]),o=t.filter(this.isLongArticle);this.count=o.length>1?"12":"6";let a="";for(const e of t){const{uuid:t}=e;t&&-1===s.indexOf(t)&&(s=`${s},${t}`);const i=C(e,"adMeta.site");i&&(a=a?`${a},${i}`:i)}const r={count:this.count,property:a,spaceId:e,uuid:s,ycts:n};this.sidekickUrl.search=new URLSearchParams(r).toString(),window.wafer.state={sidekick:this.sidekickUrl.toString()}})()}},new class{constructor(){this.clusterUuids=[]}init(t){if(!function(t){var e,i;return 1===(null===(e=t.rightRail)||void 0===e||null===(i=e.moduleConfig)||void 0===i?void 0:i.length)}(t))return;if(!t.rightRail.disableSidekick)return;this.config=t;const e=this.initRightRail.bind(this);window.wafer.on("caas:article:fetch",e)}async onContentChange(t){const{cluster:e=[]}=t;this.clusterUuids=[];for(const t of e)t.uuid&&this.clusterUuids.push(t.uuid)}initRightRail(t){const e=t.elem;if(!(null==e?void 0:e.classList.contains("wafer-caas-complete")))return;const i=e.getElementsByClassName("caas-dynamic-placeholder")[0];if(!i)return;const[n]=this.config.rightRail.moduleConfig,{classes:s,rmp:o,xhrPathPrefix:a="/nel_ms/_rcv/remote"}=n,{ctrl:r,m_id:c,config:d}=o,{modClasses:l,successClassName:h}=s;if(!o||i.classList.contains(h))return;const{spaceId:w,uuid:u}=t.meta.data,{site:p,region:m,lang:f,device:g,rid:y}=this.config.context;this.clusterUuids.includes(u)||this.clusterUuids.push(u);const A=v({ctrl:r,device:g,lang:f,m_id:c,m_mode:"json",region:m,rid:y,site:p}),C=`${b()?"":"https://www.yahoo.com"}${a}?${A}`,S={...d,ncpQueryParams:{...d.ncpQueryParams,dedupUuids:this.clusterUuids.join(),device:g,site:p,spaceId:w,uuid:u}},k=JSON.stringify({config:S,ctrl:r,m_id:c,m_mode:"json"}),I=S?`data-wf-body=${k}`:"";i.innerHTML=`<div class="wafer-fetch ${l} "data-wf-trigger="viewport" data-wf-cache-ttl="300" data-wf-trigger-offset="300 0" data-wf-url="${C}" ${I}></div>`,i.classList.add(h),window.wafer.base.sync(i)}},new class{constructor(){this.home=new URL(location.href),this.isViewerClosed=!0}init(t){t&&(this.site=t.context.site||"fp",t.retainSearchParams&&(this.retainSearchParams=t.retainSearchParams),this.navigationTimeout=t.navigationTimeout),this.infoBeaconUri=g(this.site);const e=document.querySelector('link[rel="canonical"]');e&&(this.canonicalEl=e,this.canonicalElStartVal=e.getAttribute("href")),window.addEventListener("popstate",this.onPopState.bind(this)),window.wafer.on("caas:article:init",(()=>{this.dispatch(s,this.payload)})),window.wafer.on("caas:article:inview",(t=>{this.navigateFailureTimeout&&clearTimeout(this.navigateFailureTimeout);const{data:e}=t.meta;let i=e.homepageUrl||e.url;for(const t of[this.payload,...this.payload.cluster])if(t.uuid===e.uuid&&t.pathname){i=t.pathname;break}i!==location.pathname&&this.replaceState(this.payload,i)})),window.wafer.on("caas:article:error",(t=>{const{viewerMainArticleId:e}=window.wafer.base._state,{hasData:i,hasMarkup:n,type:s,url:o,uuid:a}=t.meta;a===e?this.onNavigateFailure(o,`fetcherror;hasData:${i};hasMarkup:${n};type:${s}`):this.onClusterArticleFailure(o)})),window.wafer.on("caas:sidekick:error",(t=>{const e=new Image,i=v({connection:JSON.stringify(y()),error:"sidekick_error",url:t.meta.url});e.src=`/${this.infoBeaconUri}?${i}`}))}onClusterArticleFailure(t){this.beaconFailure("cluster_article_failure",t)}onNavigateFailure(t,e=""){e=e&&`:${e}`,this.beaconFailure(`navigate_failure${e}`,t),setTimeout((()=>{if(this.isViewerClosed)return;let t="";"frontpage"!==this.site&&"fp"!==this.site||(t="?.tsrc=fp_deeplink");let e=`${this.payload.pathname}${t}`;e=P(e),window.location.href=e}),500)}beaconFailure(t,e){const i=new Image,n=v({connection:JSON.stringify(y()),error:t,url:e,...S()});i.src=`/${this.infoBeaconUri}?${n}`}onClick(t){switch(t.type){case"article":const e=t.payload;this.navigateFailureTimeout=window.setTimeout((()=>{const t=location.origin+e.pathname;this.onNavigateFailure(t,"timeout")}),this.navigationTimeout||6e3),this.isViewerClosed&&this.dispatch(o),this.navigateToArticle(e),this.pushState(e,e.pathname),this.canonicalEl&&this.canonicalEl.setAttribute("href",location.href);break;case"back":this.onHeaderBackButtonClicked();break;case"close":case"overlay":this.navigateHome(),this.pushState({},this.home.href)}}onViewerWillOpen(){this.home=new URL(location.href)}async navigateToArticle(t){this.payload=t,await this.dispatch(i,t),this.isViewerClosed&&(await this.dispatch(a,t),this.isViewerClosed=!1),await this.dispatch(n,t)}onHeaderBackButtonClicked(){history.back()}async navigateHome(){this.isViewerClosed||(this.isViewerClosed=!0,this.canonicalEl&&this.canonicalElStartVal&&this.canonicalEl.setAttribute("href",this.canonicalElStartVal),await this.dispatch(r),setTimeout((()=>this.dispatch(c)),0))}async onPopState(){const t=window.history.state||{};window.location.href===this.home.href?await this.navigateHome():t.isHpViewer&&this.navigateToArticle(t)}getHrefWithQueryParams(t){const e=new URL(t,location.origin);return this.retainSearchParams&&this.retainSearchParams.length&&this.retainSearchParams.forEach((t=>{if(!e.searchParams.has(t)&&this.home.searchParams.has(t)){const i=String(this.home.searchParams.get(t));e.searchParams.append(t,i)}})),e.href}pushState(t,e){history.pushState(t,"",this.getHrefWithQueryParams(e))}replaceState(t,e){history.replaceState(t,"",this.getHrefWithQueryParams(e))}},new class{constructor(t){this.config=t,this.onScroll=this.onScroll.bind(this),this.activeSticky=this.getStickyNode(t.pageStickyNode),this.stickyBottom=t.pageStickyBottom}init(){window.wafer.ready((()=>{"function"==typeof requestAnimationFrame?window.wafer.on("scroll",(()=>requestAnimationFrame(this.onScroll))):window.wafer.on("scroll",this.onScroll)}),window)}onViewerOpened(){this.activeSticky=this.getStickyNode(this.config.viewerStickyNode),this.stickyBottom=this.config.viewerStickyBottom,this.viewerContainerNode=this.getStickyNode(this.config.viewerContainerNode)}onContentDidChange(){this.activeSticky=this.getStickyNode(this.config.viewerStickyNode),this.stickyBottom=this.config.viewerStickyBottom,this.viewerContainerNode=this.getStickyNode(this.config.viewerContainerNode)}onViewerClosed(){this.activeSticky=this.getStickyNode(this.config.pageStickyNode),this.stickyBottom=this.config.pageStickyBottom,this.viewerContainerNode=this.getStickyNode(this.config.viewerContainerNode)}getStickyNode(t){return document.querySelector(t)}onScroll(){if(window.pageYOffset>0?document.body.classList.add("has-scrolled"):document.body.classList.remove("has-scrolled"),this.activeSticky&&this.activeSticky.parentElement){const{bottom:t,height:e}=this.activeSticky.getBoundingClientRect(),i=this.viewerContainerNode?this.viewerContainerNode.getBoundingClientRect().bottom:0,n="fixed"===this.activeSticky.style.position&&!this.activeSticky.parentElement.classList.contains("sticky-flow");if(e<window.innerHeight)return;if(this.viewerContainerNode&&i<window.innerHeight){const t=window.innerHeight-i+this.stickyBottom;Object.assign(this.activeSticky.style,{bottom:t+"px",position:"fixed"}),this.activeSticky.parentElement.classList.remove("sticky-active"),this.activeSticky.parentElement.classList.add("sticky-flow")}else n?window.pageYOffset<e-window.innerHeight+this.config.rightRailTop&&(Object.assign(this.activeSticky.style,{bottom:"",position:""}),this.activeSticky.parentElement.classList.remove("sticky-active")):t<window.innerHeight&&(Object.assign(this.activeSticky.style,{bottom:this.stickyBottom+"px",position:"fixed"}),this.activeSticky.parentElement.classList.add("sticky-active"),this.activeSticky.parentElement.classList.remove("sticky-flow"))}}get rightRail(){return document.getElementsByClassName("viewer-aside")[0]}}({pageStickyBottom:30,pageStickyNode:"#Aside .aside-sticky",rightRailTop:91,viewerContainerNode:"#content-articles-wrapper",viewerStickyBottom:60,viewerStickyNode:"#viewer-aside .aside-sticky"}),new class{constructor(){this.home=new URL(location.href),this.scrollHistory={}}onContentWillChange(t){const{pathname:e}=location;e!==t.pathname&&this.saveScrollPosition(e)}onContentChange(t){this.restoreScrollPosition(t.pathname)}onViewerWillOpen(){this.home=new URL(location.href),window.history&&(window.history.scrollRestoration="manual")}onViewerClosed(){const{pathname:t}=location;t!==this.home.pathname&&this.saveScrollPosition(t)}onViewerDidClose(){const{pathname:t}=location;this.restoreScrollPosition(t),window.history&&(window.history.scrollRestoration="auto")}saveScrollPosition(t){this.scrollHistory[t]={x:window.pageXOffset,y:window.pageYOffset}}restoreScrollPosition(t){const{x:e=0,y:i=0}=this.scrollHistory[t]||{};window.scrollTo(e,i)}},new class{constructor(){this.title=document.title}init(){window.wafer.on("caas:article:inview",(t=>{document.title=t.meta.data.title}))}onViewerClosed(){document.title=this.title}},new class{init(t){var e,i;if(!window.rapidInstance)return;window._comscore=window._comscore||[],this.c14=(null===(e=window.YAHOO)||void 0===e||null===(i=e.comscore)||void 0===i?void 0:i.c14)||"-1",this.spaceId=window.rapidInstance.getRapidAttribute("spaceid");const n=this.beaconPageView.bind(this);window.wafer.on("caas:article:inview",n)}onViewerDidClose(){if(!window.rapidInstance)return;const t=new URL(location.pathname,location.origin).toString();this.beaconComscore(this.spaceId,t)}async beaconPageView(t){const{spaceId:e,url:i}=t.meta.data;this.beaconComscore(e,i)}async beaconComscore(t,e){var i;window._comscore=window._comscore||[],window._comscore.push({c1:2,c14:this.c14,c2:"7241469",c5:t,c7:e}),null===(i=window.COMSCORE)||void 0===i||i.purge()}},new class{constructor(){this.trackedItemsInViewer={}}init(t){t&&(this.meta={assetid:window.location.pathname,section:"Yahoo!",type:"static"}),this.nSdkInstance=window.nSdkInstance,this.nSdkNseNo=window.nSdkNseNo,window.wafer.on("caas:article:inview",(t=>{t.meta&&t.meta.data&&t.meta.data.uuid&&!this.trackedItemsInViewer[t.meta.data.uuid]&&(this.nielsenSpaEvent("caas:article:inview"),this.trackedItemsInViewer[t.meta.data.uuid]=!0)}))}onViewerOpened(){this.nSdkNseNo=window.nSdkNseNo,this.trackedItemsInViewer={}}onViewerDidClose(){this.trackedItemsInViewer={},this.nielsenSpaEvent("viewerClosed")}nielsenSpaEvent(t){var e=window.location;this.nSdkInstance&&void 0!==this.nSdkNseNo&&this.meta&&(this.nSdkInstance.ggPM("staticend",this.meta),this.nSdkNseNo=++this.nSdkNseNo,this.meta.referrerURL=this.meta.pageURL||e.href,this.meta.pageURL="page_"+this.nSdkNseNo+"_"+e.href,this.meta.assetid=e.pathname,this.nSdkInstance.ggPM("staticstart",this.meta),"viewerClosed"===t&&(window.nSdkNseNo=this.nSdkNseNo))}},new class{init(t){}onClick(t){R&&"article"===t.type&&performance.mark("article_link_clicked")}onViewerClosed(){R&&performance.clearMarks("article_link_clicked")}},new class{constructor(){this.playingVideos=[]}onViewerOpened(){var t,e;this.playingVideos=[];const i=(null===(t=window.context)||void 0===t||null===(e=t.getStore("VideoPlayerStore"))||void 0===e?void 0:e.getVideoPlayers())||[];for(const{player:t}of i)t.controls.isPlaying()&&(this.playingVideos.push(t),t.controls.pause())}onViewerDidClose(){for(const t of this.playingVideos)t.controls.play();this.playingVideos=[]}},new class{constructor(){}init(t){}onClick(t){window.postMessage({action:"y:homepage:click",props:{type:t.type}},"*")}},new class{constructor(){this.missedArticleInViewEvents=[],this.isEnabled=!1,this.isScriptLoaded=!1,this.comments={}}async init(t){var e;const i=document.getElementById("spotim-config"),n=i&&window.wafer.utils.getConfigFromJSONScriptNode(i)||{};if(null!=t&&null!==(e=t.spotIm)&&void 0!==e&&e.enabled||null!=n&&n.enabled){this.isEnabled=!0;const{config:e,spotImJsUrl:i}=t.spotIm||n;this.spotImConfig=e,this.spotImJsUrl=i;const s=this.onArticleInView.bind(this);window.wafer.on("caas:article:inview",s)}}async loadSpotIm(){return new Promise(((t,e)=>{const i=document.createElement("script");i.async=!0,i.src=this.spotImJsUrl,i.onload=t,i.onerror=e,document.body.appendChild(i)}))}async onViewerOpened(){this.isEnabled&&this.loadSpotImIfNeeded()}async onContentWillChange(){this.missedArticleInViewEvents=[]}async loadSpotImIfNeeded(){if(!this.isScriptLoaded){try{await this.loadSpotIm()}catch(t){console.error("spotIm js file load error",t)}this.isScriptLoaded=!0,this.processMissedEvents()}}async processMissedEvents(){this.missedArticleInViewEvents.length&&(this.missedArticleInViewEvents.forEach((t=>this.onArticleInView(t))),this.missedArticleInViewEvents=[])}onViewerDidClose(){this.comments={},this.missedArticleInViewEvents=[]}initComments(t,e){const i=document.getElementById(t);if(!i)return;const{url:n,uuid:s}=e,{pitcEnabled:o}=this.spotImConfig,a={...this.spotImConfig,url:n,uuid:s},r="mainArticleIdComments"===i.id,c={detail:{config:{...a,pitcEnabled:!1},elem:i,isMain:r}};if(dispatchEvent(new CustomEvent("initSpotImComments",c)),o&&r){const t=document.getElementById("viewer-spotIm-pitc-root");dispatchEvent(new CustomEvent("initSpotImPitc",{detail:{config:a,elem:t}}))}this.comments[s]={commentsNode:i,id:t}}onArticleInView(t){this.isScriptLoaded?this.initCommentsOnView(t):this.missedArticleInViewEvents.push(t)}initCommentsOnView(t){if(window.YAHOO){const e=t.meta.data,i=e.uuid;if(!e.commentsAllowed)return;if(this.comments[i])return;const n=t.elem.getAttribute("data-comments-id");this.initComments(n,e)}}async onClick(t){if(this.isEnabled&&"comments"===t.type){var e,i;const n=t.payload.uuid,s=null===(e=this.comments[n])||void 0===e?void 0:e.commentsNode;null==s||null===(i=s.scrollIntoView)||void 0===i||i.call(s,{behavior:"smooth",block:"center"})}}},new class{constructor(){document.getElementById("content-viewer-template")||window.wafer.ready((()=>{this.bootstrap()}))}init(){}async bootstrap(){var t;const e=S(),i=null==e?void 0:e.apptype,n=(null==e?void 0:e.region)||"US",s=null==e?void 0:e.device,o=null==e?void 0:e.contentSite,{site:a="fp",...r}=null===(t=window.rapidInstance)||void 0===t?void 0:t.getRapidAttribute("keys"),c=(null==e?void 0:e.lang)||r.lang||"en-US",d={contentSite:o,device:s,lang:c,region:n,site:a},l=`${b()?"":"https://www.yahoo.com"}${o?`/${o}/layouts`:"/layouts"}?${v({apptype:i,device:s,lang:c,region:n,site:a})}`;try{var h,w;const{configs:t,layout:e}=await window.wafer.utils.fetchWithCache(l,{cacheStrategy:"cacheFirst",cacheTtl:1e3,credentials:"include"});document.body.insertAdjacentHTML("beforeend",e),window.adsConfig=window.adsConfig||t.ads,null!==(h=t.viewer)&&void 0!==h&&null!==(w=h.rightRail)&&void 0!==w&&w.disableSidekick&&t.ads&&(window.adsConfig=t.ads),window.YAHOO.viewer.init({context:d,...t.viewer})}catch(t){window.YAHOO.viewer.init({context:d});const i=`/${g((null==e?void 0:e.site)||"fp")}?error=layout_fetch_failed&message=${null==t?void 0:t.message}`;window.wafer.utils.fireBeacon(i,{useNavigator:!1,useTimestamp:!1})}window.wafer.base.sync(document.body)}}];L.push(new class{constructor(){this.homeProperty=window.location.hostname.split(".",1)+""}init(){"function"==typeof C(window,"s.t")&&(this.adobeAnalytics=window.s,window.wafer.on("caas:article:inview",this.adobeAnalytics.t))}async onContentDidChange(){this.adobeAnalytics&&(this.adobeAnalytics.prop53="Modal")}async onClick({type:t}){this.adobeAnalytics&&"article"===t&&setTimeout((()=>{const t=this.adobeAnalytics.pna||"",e=window.location.hostname.split(".",1);this.adobeAnalytics.pageName=`net|${e}|${t}`}),10)}async onViewerClosed(){if(!this.adobeAnalytics)return;const t=this.adobeAnalytics.pna||"";this.adobeAnalytics.pageName=`net|${this.homeProperty}|${t}`,this.adobeAnalytics.prop53="Modal Close",setTimeout((()=>{this.adobeAnalytics.t(),this.adobeAnalytics.clearVars()}),5)}}),window.YAHOO.viewer=new class{constructor(t){this.handlers={};const e=this.dispatch.bind(this);t.forEach((t=>t.dispatch=e)),this.mapPluginHandlers(t)}mapPluginHandlers(t){for(const e in d)if(e in d){this.handlers[e]=[];for(const i of t)if(e in i){const t=i[e].bind(i);this.handlers[e].push(t)}}}init(e){this.dispatch(t,e)}dispatch(t,...e){const i=[];for(const n of this.handlers[t]){const t=n(...e);t instanceof Promise&&i.push(t)}return Promise.all(i)}}(L)}();
//# sourceMappingURL=desktop_1.9.330.modern.js.map
